labs(x = 'Scenario', y = 'USD billion per year', fill = '', title = '\n1.5°C pathway') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
legend.text = element_text(size = 10),
axis.title.x = element_blank(),
legend.key = element_rect(size = 2, fill = "white", colour = "white"),
legend.key.size = unit(0.5, "cm"),
axis.text.y = element_text(size = 12),
plot.title = element_text(size = 13)) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
scale_y_continuous(limits = c(0, 2500), breaks = c(seq(0, 2000, 1000)))
plot_grid(p1, p2, nrow = 1, rel_widths = c(2/5, 3/5))
p3 <- ggplot(shift.invest %>% filter(region %in% reg2 & variable %in% e.group2)) +
geom_bar(aes(region, `CPol`, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion per year', fill = '', title = 'Annual investments (2020-2024)\nCurrent policy') + #total investments 2020-2025
theme_bw() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, size = 12),
axis.text.y = element_text(size = 12),
legend.key.height=unit(1, "cm"),
legend.text = element_text(size = 12),
axis.title.x = element_blank(),
plot.title = element_text(size = 13)) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
scale_y_continuous(limits = c(0, 500), breaks = c(0, 500, 250))
p4 <- ggplot(shift.invest %>% filter(region %in% reg2 & variable %in% e.group2)) +
geom_bar(aes(region, `1.5C`, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion per year', fill = '', title = '\n1.5°C pathway') +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
axis.text.y = element_text(size = 12),
legend.key.height=unit(1, "cm"),
legend.text = element_text(size = 12),
axis.title.x = element_blank(),
legend.key = element_rect(size = 2, fill = "white", colour = "white"),
legend.key.size = unit(0.5, "cm")) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
scale_y_continuous(limits = c(0, 500), breaks = c(0, 500, 250))
plot_grid(p3, p4, nrow = 1, rel_widths = c(2/5, 3/5))
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
#legend.text = element_text(size = 7),
legend.position = 'none',
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12) ) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
geom_point(aes(region, net), shape=95, size=15, alpha = 0.40, color = 'black')
p6 <- ggplot(shift.invest %>% filter(region %in% reg2 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = '\n') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
#legend.text = element_text(size = 7),
axis.title.x = element_blank()) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
geom_point(aes(region, net), shape=95, size=15, alpha = 0.40, color = 'black')
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw()
p5
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
#legend.text = element_text(size = 7),
legend.position = 'none',
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12))
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
legend.text = element_text(size = 7),
legend.position = 'none',
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12))
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12))
p5
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
legend.text = element_text(size = 7),
legend.position = 'none',
axis.title.x = element_blank(),
axis.text.y = element_text(size = 12)) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
geom_point(aes(region, net), shape=95, size=15, alpha = 0.40, color = 'black')
p5
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
legend.text = element_text(size = 7),
legend.position = 'none',
axis.title.x = element_blank(),
axis.text.y = element_text(size = 12)) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
geom_point(aes(region, net), shape=95, size=15, alpha = 0.40, color = 'black')
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
legend.text = element_text(size = 7),
legend.position = 'none',
axis.title.x = element_blank(),
axis.text.y = element_text(size = 12)) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
geom_point(aes(region, net), shape=95, size=15, alpha = 0.40, color = 'black')
p6 <- ggplot(shift.invest %>% filter(region %in% reg2 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion', fill = '', title = '\n') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
#legend.text = element_text(size = 7),
axis.title.x = element_blank()) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
geom_point(aes(region, net), shape=95, size=15, alpha = 0.40, color = 'black')
plot_grid(p5, p6, nrow = 1)
gdp.reg <- read.csv("data/gdp_2019_wb.csv", skip = 3) %>%
rename_all(tolower) %>%
left_join(iam.regs, by = 'country.code') %>%
filter(!region == 'EU' & !duplicated(country.code)) %>%
pivot_longer(x1960:x2019, names_to = "year", values_to = "gdp") %>%
mutate(year = year %>% str_replace("x", "")) %>%
filter(year == 2019) %>%
select(region, gdp) %>%
group_by(region) %>%
mutate(gdp = sum(gdp, na.rm = T)) %>%
ungroup() %>%
filter(!duplicated(region)) %>%
mutate(World = sum(gdp, na.rm = T)) %>%
spread(region, gdp) %>%
gather(region, gdp) %>%
as.data.frame()
gdp.cntry <- read.csv("data/gdp_2019_wb.csv", skip = 3) %>%
rename_all(tolower) %>%
pivot_longer(x1960:x2019, names_to = "year", values_to = "gdp") %>%
mutate(year = year %>% str_replace("x", "")) %>%
filter(year == 2019) %>%
mutate(EU = 15.5e12) %>%
filter(country.code %in% c('USA', 'CHN', 'IND')) %>%
select(country.code, gdp, EU) %>%
spread(country.code, gdp) %>%
gather(region, gdp)
gdp.master <- gdp.reg %>%
bind_rows(gdp.cntry)
scenario <- data.frame(scenario = c('1.5C', 'CPol'))
stim.prep <- master.stim %>%
left_join(gdp.master, by = 'region') %>%
mutate(pct.gdp = stimulus/gdp*100,
invest.type = 'Stimulus') %>%
rename(variable = component,
avg.invest = stimulus) %>%
merge(scenario)
e.group3 <- c('Low carbon sources', 'Fossil fuels', 'General spending', 'Health sector spending', 'Liquidity support')
gdp.shares <- invest %>%
group_by(region, variable, scenario, year) %>%
mutate(avg.invest = mean(investment)) %>% # mean across models
ungroup() %>%
filter(model == 'MESSAGEix-GLOBIOM') %>% # removing duplicates after averaging across models
select(-model) %>%
group_by(region, variable, scenario) %>%
mutate(avg.invest = mean(avg.invest)*1e9) %>% # mean across years
ungroup() %>%
filter(year == 2020 & scenario %in% c('1.5C', 'CPol')) %>%
select(-year, -investment) %>%
left_join(gdp.master, by = 'region')  %>%
mutate(pct.gdp = avg.invest/gdp*100,
invest.type = 'Energy investment') %>%
bind_rows(stim.prep) %>%
#bind_rows(shift.prep) %>%
mutate(variable = factor(variable, levels = e.group3)) %>%
filter(scenario == '1.5C')
p10 <- ggplot(gdp.shares %>% filter(region %in% reg2 & scenario == '1.5C')) +
geom_bar(aes(invest.type, pct.gdp, fill = variable), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
facet_wrap(~region, scales = 'free') +
theme_bw() +
theme(axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12),
axis.title.x = element_blank(),
legend.position = "bottom") +
labs(y = '% GDP', fill = '') +
scale_fill_manual(values = c('Fossil fuels' = '#f5a788',
'Low carbon sources' = '#acb96a',
'General spending' = '#c6dbef',
'Health sector spending' = '#9ecae1',
'Liquidity support' = '#6baed6')) +
guides(fill = guide_legend(nrow = 1))
legend <- cowplot::get_legend(p10)
p11 <- ggplot(gdp.shares %>% filter(region %in% reg1 & scenario == '1.5C')) +
geom_bar(aes(invest.type, pct.gdp, fill = variable), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
facet_grid(~region) +
theme_bw() +
theme(legend.text = element_text(size = 7),
axis.title.x = element_blank(),
legend.position="none",
axis.text.x = element_text(size = 9, angle = 90)) +
labs(y = '% GDP') +
scale_fill_manual(values = c('Fossil fuels' = '#f5a788',
'Low carbon sources' = '#acb96a',
'General spending' = '#c6dbef',
'Health sector spending' = '#9ecae1',
'Liquidity support' = '#6baed6'))
p12 <- ggplot(gdp.shares %>% filter(region %in% reg2 & scenario == '1.5C')) +
geom_bar(aes(invest.type, pct.gdp, fill = variable), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
facet_grid(~region) +
theme_bw() +
theme(legend.text = element_text(size = 7),
axis.title.x = element_blank(),
legend.position="none",
axis.text.x = element_text(size = 9, angle = 90)) +
labs(y = '% GDP') +
scale_fill_manual(values = c('Fossil fuels' = '#f5a788',
'Low carbon sources' = '#acb96a',
'General spending' = '#c6dbef',
'Health sector spending' = '#9ecae1',
'Liquidity support' = '#6baed6'))
p13 <- ggplot(gdp.shares %>% filter(region %in% reg1 & scenario == '1.5C')) +
geom_bar(aes(invest.type, avg.invest/10^9, fill = variable), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
facet_grid(~region) +
theme_bw() +
theme(axis.text.x = element_text(size = 9, angle = 90),
legend.text = element_text(size = 7),
axis.title.x = element_blank(),
legend.position="none") +
labs(y = 'USD billion', fill = 'Category') +
scale_fill_manual(values = c('Fossil fuels' = '#f5a788',
'Low carbon sources' = '#acb96a',
'General spending' = '#c6dbef',
'Health sector spending' = '#9ecae1',
'Liquidity support' = '#6baed6'))
p14 <- ggplot(gdp.shares %>% filter(region %in% reg2 & scenario == '1.5C')) +
geom_bar(aes(invest.type, avg.invest/10^9, fill = variable), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
facet_grid(~region) +
theme_bw() +
theme(axis.text.x = element_text(size = 9, angle = 90),
legend.text = element_text(size = 7),
axis.title.x = element_blank(),
legend.position="none") +
labs(y = 'USD billion', fill = 'Category') +
scale_fill_manual(values = c('Fossil fuels' = '#f5a788',
'Low carbon sources' = '#acb96a',
'General spending' = '#c6dbef',
'Health sector spending' = '#9ecae1',
'Liquidity support' = '#6baed6'))
panels1 <- plot_grid(p11, p12)
panels2 <- plot_grid(p13, p14)
title <- ggdraw() +
draw_label("      Energy investments compatible with 1.5°C (avg/yr) vs stimulus packages",
fontface = 'bold',
x = 0,
hjust = 0) +
theme(plot.margin = margin(0, 0, 0, 7))
plot_grid(title, panels1, legend, ncol = 1, rel_heights = c(0.1, 1, 0.12))
plot_grid(title, panels2, legend, ncol = 1, rel_heights = c(0.1, 1, 0.12))
p3 <- ggplot(shift.invest %>% filter(region %in% reg2 & variable %in% e.group2)) +
geom_bar(aes(region, `CPol`, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion per year', fill = '', title = 'Annual investments (2020-2024)\nCurrent policy') + #total investments 2020-2025
theme_bw() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90, size = 12),
axis.text.y = element_text(size = 12),
legend.key.height=unit(1, "cm"),
legend.text = element_text(size = 12),
axis.title.x = element_blank(),
plot.title = element_text(size = 13)) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
scale_y_continuous(limits = c(0, 500), breaks = c(0, 500, 250))
p4 <- ggplot(shift.invest %>% filter(region %in% reg2 & variable %in% e.group2)) +
geom_bar(aes(region, `1.5C`, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion per year', fill = '', title = '\n1.5°C pathway') +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
axis.text.y = element_text(size = 12),
legend.key.height=unit(1, "cm"),
legend.text = element_text(size = 12),
axis.title.x = element_blank(),
legend.key = element_rect(size = 2, fill = "white", colour = "white"),
legend.key.size = unit(0.5, "cm")) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
scale_y_continuous(limits = c(0, 500), breaks = c(0, 500, 250))
plot_grid(p3, p4, nrow = 1, rel_widths = c(2/5, 3/5))
p5 <- ggplot(shift.invest %>% filter(region %in% reg1 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion per year', fill = '', title = 'Annual shift in energy investments:\n1.5°C vs. current policy (2020-2024)') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
legend.text = element_text(size = 7),
legend.position = 'none',
axis.title.x = element_blank(),
axis.text.y = element_text(size = 12)) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
geom_point(aes(region, net), shape=95, size=15, alpha = 0.40, color = 'black')
p6 <- ggplot(shift.invest %>% filter(region %in% reg2 & variable %in% e.group2)) +
geom_bar(aes(region, shift, fill = str_wrap(factor(variable, levels = e.group2), 10)), width = 0.5, stat = 'identity', color = 'white', size = 0.1) +
labs(x = 'Scenario', y = 'USD billion per year', fill = '', title = '\n') + #total investments 2020-2025
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
#legend.text = element_text(size = 7),
axis.title.x = element_blank()) +
scale_fill_manual(values = c('Fossil\nfuels' = '#f5a788',
'Low carbon\nsources' = '#acb96a')) +
geom_point(aes(region, net), shape=95, size=15, alpha = 0.40, color = 'black')
plot_grid(p5, p6, nrow = 1)
# Fig S1
ggplot(stim.reg %>% filter(region %in% reg1)) +
geom_bar(aes(region, stimulus/1e9, fill = component), width = 0.6, stat = 'identity') +
labs(x = 'Country', y = 'USD billion', fill = '', title = 'Stimulus packages') +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_blank(),
legend.text = element_text(size = 12)) +
scale_fill_manual(values = stim.col)
# Fig S2
ggplot(stim.big.cntry %>% filter(country.code %in% reg2)) +
geom_bar(aes(country.code, stimulus/1e9, fill = component), width = 0.6, stat = 'identity') +
labs(x = 'Country', y = 'USD billion', fill = '', title = 'Stimulus packages') +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_blank(),
legend.text = element_text(size = 12)) +
scale_fill_manual(values = stim.col)
plot_grid(p1, p2, nrow = 1, rel_widths = c(2/5, 3/5))
plot_grid(p3, p4, nrow = 1, rel_widths = c(2/5, 3/5))
plot_grid(p5, p6, nrow = 1)
plot_grid(title, panels1, legend, ncol = 1, rel_heights = c(0.1, 1, 0.12))
plot_grid(title, panels2, legend, ncol = 1, rel_heights = c(0.1, 1, 0.12))
invest.prep <- read_excel('data/NE_paper_SM_data.xlsx', sheet = 'Investment_Annual') %>%
rename_all(tolower) %>%
mutate(region = recode(region, 'R5ASIA' = 'ASIA', 'R5LAM' = 'LAM', 'R5MAF' = 'MAF', 'R5OECD90+EU' = 'OECD+', 'R5REF' = 'REF')) %>%
select(model, region, scenario, variable, '2020':'2050') %>%
filter(variable %in% e.type1) %>%
pivot_longer('2020':'2025', names_to = 'year', values_to = 'investment') %>%
mutate(year = as.integer(year),
investment = str_remove(investment, "%") %>% as.numeric(investment))
interp <- function(df) {
with(df, approx(x=index, y=value, xout=min(index):max(index))) %>%
bind_cols()
}
invest.interp <- invest.prep %>%
group_by(scenario, model, region, variable) %>%
rename(index = year, value = investment) %>%
do(interp(.)) %>%
rename(year = x, investment = y) %>%
right_join(invest.prep %>% distinct(region), by = 'region')
e.group2 <- c('Fossil fuels', 'Low carbon sources') # for aggregation to only two broad groups of energy investments
invest <- invest.interp %>%
spread(variable, investment) %>%
mutate('Fossil fuels' = `Electricity - Fossil Fuels w/o CCS` + `Hydrogen - Fossil` + `Extraction and Conversion - Fossil Fuels`,
'Low carbon sources' = `Extraction and Conversion - Nuclear` + `CCS` + `Electricity - Non-bio Renewables` + `Hydrogen - Non-fossil`
+ `Extraction and Conversion - Bioenergy` + `Electricity - T&D and Storage` + `Energy Efficiency`) %>%
gather(variable, investment, -c(model, region, scenario, year)) %>%
filter(variable %in% e.group2) %>%
mutate(investment = investment * 1.0728) #adjust for inflation to current dollars
model.spread.shift <- invest %>%
filter(!year == 2050) %>%
group_by(region, variable, model, scenario) %>%
mutate(annual.avg = mean(investment)) %>% # yearly average
ungroup()  %>%
select(-investment) %>%
filter(year == 2020) %>%
spread(scenario, annual.avg) %>%
mutate(shift = `1.5C` - `CPol`) %>%
group_by(region, variable) %>%
mutate(mean.shift = mean(shift),
max.shift = max(shift),
min.shift = min(shift)) %>%
ungroup()
ggplot(model.spread.shift %>% filter(region %in% reg1), aes(region, shift, fill = variable)) +
stat_summary(geom = 'bar', fun = mean, position = 'dodge') +
stat_summary(geom = 'errorbar', fun.min = min, fun.max = max, position = 'dodge') +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 12),
plot.title = element_text(size = 13)) +
scale_fill_manual(values = c('Fossil fuels' = '#f5a788',
'Low carbon sources' = '#acb96a')) +
labs(title = 'Shifts in annual energy investments between current policy and 1.5°C pathway')
invest.prep <- read_excel('data/NE_paper_SM_data.xlsx', sheet = 'Investment_Annual') %>%
rename_all(tolower) %>%
mutate(region = recode(region, 'R5ASIA' = 'ASIA', 'R5LAM' = 'LAM', 'R5MAF' = 'MAF', 'R5OECD90+EU' = 'OECD+', 'R5REF' = 'REF')) %>%
select(model, region, scenario, variable, '2020':'2025') %>%
filter(variable %in% e.type1) %>%
pivot_longer('2020':'2025', names_to = 'year', values_to = 'investment') %>%
mutate(year = as.integer(year),
investment = str_remove(investment, "%") %>% as.numeric(investment))
image <- invest.prep %>% filter(model == 'IMAGE')
View(image)
interp <- function(df) {
with(df, approx(x=index, y=value, xout=min(index):max(index))) %>%
bind_cols()
}
invest.interp <- invest.prep %>%
group_by(scenario, model, region, variable) %>%
rename(index = year, value = investment) %>%
do(interp(.)) %>%
rename(year = x, investment = y) %>%
right_join(invest.prep %>% distinct(region), by = 'region')
image <- invest %>% filter(model == 'IMAGE')
invest.prep <- read_excel('data/NE_paper_SM_data.xlsx', sheet = 'Investment_Annual') %>%
rename_all(tolower) %>%
mutate(region = recode(region, 'R5ASIA' = 'ASIA', 'R5LAM' = 'LAM', 'R5MAF' = 'MAF', 'R5OECD90+EU' = 'OECD+', 'R5REF' = 'REF')) %>%
select(model, region, scenario, variable, '2020':'2025') %>%
filter(variable %in% e.type1) %>%
pivot_longer('2020':'2050', names_to = 'year', values_to = 'investment') %>%
mutate(year = as.integer(year),
investment = str_remove(investment, "%") %>% as.numeric(investment))
interp <- function(df) {
with(df, approx(x=index, y=value, xout=min(index):max(index))) %>%
bind_cols()
}
invest.interp <- invest.prep %>%
group_by(scenario, model, region, variable) %>%
rename(index = year, value = investment) %>%
do(interp(.)) %>%
rename(year = x, investment = y) %>%
right_join(invest.prep %>% distinct(region), by = 'region')
e.group2 <- c('Fossil fuels', 'Low carbon sources') # for aggregation to only two broad groups of energy investments
invest <- invest.interp %>%
spread(variable, investment) %>%
mutate('Fossil fuels' = `Electricity - Fossil Fuels w/o CCS` + `Hydrogen - Fossil` + `Extraction and Conversion - Fossil Fuels`,
'Low carbon sources' = `Extraction and Conversion - Nuclear` + `CCS` + `Electricity - Non-bio Renewables` + `Hydrogen - Non-fossil`
+ `Extraction and Conversion - Bioenergy` + `Electricity - T&D and Storage` + `Energy Efficiency`) %>%
gather(variable, investment, -c(model, region, scenario, year)) %>%
filter(variable %in% e.group2) %>%
mutate(investment = investment * 1.0728) #adjust for inflation to current dollars
image <- invest %>% filter(model == 'IMAGE')
invest.prep <- read_excel('data/NE_paper_SM_data.xlsx', sheet = 'Investment_Annual') %>%
rename_all(tolower) %>%
mutate(region = recode(region, 'R5ASIA' = 'ASIA', 'R5LAM' = 'LAM', 'R5MAF' = 'MAF', 'R5OECD90+EU' = 'OECD+', 'R5REF' = 'REF')) %>%
select(model, region, scenario, variable, '2020':'2050') %>%
filter(variable %in% e.type1) %>%
pivot_longer('2020':'2050', names_to = 'year', values_to = 'investment') %>%
mutate(year = as.integer(year),
investment = str_remove(investment, "%") %>% as.numeric(investment))
interp <- function(df) {
with(df, approx(x=index, y=value, xout=min(index):max(index))) %>%
bind_cols()
}
invest.interp <- invest.prep %>%
group_by(scenario, model, region, variable) %>%
rename(index = year, value = investment) %>%
do(interp(.)) %>%
rename(year = x, investment = y) %>%
right_join(invest.prep %>% distinct(region), by = 'region')
e.group2 <- c('Fossil fuels', 'Low carbon sources') # for aggregation to only two broad groups of energy investments
invest <- invest.interp %>%
spread(variable, investment) %>%
mutate('Fossil fuels' = `Electricity - Fossil Fuels w/o CCS` + `Hydrogen - Fossil` + `Extraction and Conversion - Fossil Fuels`,
'Low carbon sources' = `Extraction and Conversion - Nuclear` + `CCS` + `Electricity - Non-bio Renewables` + `Hydrogen - Non-fossil`
+ `Extraction and Conversion - Bioenergy` + `Electricity - T&D and Storage` + `Energy Efficiency`) %>%
gather(variable, investment, -c(model, region, scenario, year)) %>%
filter(variable %in% e.group2) %>%
mutate(investment = investment * 1.0728) #adjust for inflation to current dollars
image <- invest %>% filter(model == 'IMAGE')
model.spread.shift <- invest %>%
filter(!year == 2050) %>%
group_by(region, variable, model, scenario) %>%
mutate(annual.avg = mean(investment)) %>% # yearly average
ungroup()  %>%
select(-investment) %>%
filter(year == 2020) %>%
spread(scenario, annual.avg) %>%
mutate(shift = `1.5C` - `CPol`) %>%
group_by(region, variable) %>%
mutate(mean.shift = mean(shift),
max.shift = max(shift),
min.shift = min(shift)) %>%
ungroup()
ggplot(model.spread.shift %>% filter(region %in% reg1), aes(region, shift, fill = variable)) +
stat_summary(geom = 'bar', fun = mean, position = 'dodge') +
stat_summary(geom = 'errorbar', fun.min = min, fun.max = max, position = 'dodge') +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 12),
plot.title = element_text(size = 13)) +
scale_fill_manual(values = c('Fossil fuels' = '#f5a788',
'Low carbon sources' = '#acb96a')) +
labs(title = 'Shifts in annual energy investments between current policy and 1.5°C pathway')
